{"ast":null,"code":"var _jsxFileName = \"/home/coapr/development/projects/patent/client/src/components/Login.js\";\nimport React, { useState, useContext } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport useAxios from '../utils/useAxios'; // Use the custom Axios hook\nimport { UserContext } from '../context/UserContext';\nimport { jwtDecode } from 'jwt-decode'; // Correct import for jwtDecode\n\nfunction Login() {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const navigate = useNavigate();\n  const {\n    login\n  } = useContext(UserContext); // Get login function from UserContext\n\n  const axiosInstance = useAxios(); // Get Axios instance with the token handling logic\n\n  const handleLogin = async e => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    try {\n      // Make the API request to the login endpoint\n      const response = await axiosInstance.post('/login', {\n        username,\n        password\n      });\n\n      // Assuming the response includes both access and refresh tokens\n      const accessToken = response.data.access_token;\n      const refreshToken = response.data.refresh_token; // If provided by the backend\n\n      // Store tokens in localStorage\n      localStorage.setItem('token', accessToken);\n      if (refreshToken) {\n        localStorage.setItem('refreshToken', refreshToken);\n      }\n\n      // Decode the access token to get user details\n      const decodedUser = jwtDecode(accessToken);\n\n      // Update user context\n      login(decodedUser, accessToken);\n\n      // Redirect to the dashboard on successful login\n      alert('Login successful');\n      navigate('/dashboard');\n    } catch (error) {\n      console.error('Login error:', error);\n      setError('Login failed. Please check your username and password.');\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }\n  }, \"Login\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleLogin,\n    className: \"needs-validation\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Username\",\n    className: \"form-control\",\n    value: username,\n    onChange: e => setUsername(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    placeholder: \"Password\",\n    className: \"form-control\",\n    value: password,\n    onChange: e => setPassword(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-primary\",\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }, loading ? 'Logging in...' : 'Login')), error && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-danger mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 17\n    }\n  }, error));\n}\nexport default Login;","map":{"version":3,"names":["React","useState","useContext","useNavigate","useAxios","UserContext","jwtDecode","Login","username","setUsername","password","setPassword","loading","setLoading","error","setError","navigate","login","axiosInstance","handleLogin","e","preventDefault","response","post","accessToken","data","access_token","refreshToken","refresh_token","localStorage","setItem","decodedUser","alert","console","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","placeholder","value","onChange","target","required","disabled"],"sources":["/home/coapr/development/projects/patent/client/src/components/Login.js"],"sourcesContent":["import React, { useState, useContext } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport useAxios from '../utils/useAxios'; // Use the custom Axios hook\nimport { UserContext } from '../context/UserContext';\nimport {jwtDecode} from 'jwt-decode'; // Correct import for jwtDecode\n\nfunction Login() {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const navigate = useNavigate();\n  const { login } = useContext(UserContext); // Get login function from UserContext\n\n  const axiosInstance = useAxios(); // Get Axios instance with the token handling logic\n\n  const handleLogin = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    try {\n      // Make the API request to the login endpoint\n      const response = await axiosInstance.post('/login', { username, password });\n      \n      // Assuming the response includes both access and refresh tokens\n      const accessToken = response.data.access_token;\n      const refreshToken = response.data.refresh_token; // If provided by the backend\n      \n      // Store tokens in localStorage\n      localStorage.setItem('token', accessToken);\n      if (refreshToken) {\n        localStorage.setItem('refreshToken', refreshToken);\n      }\n\n      // Decode the access token to get user details\n      const decodedUser = jwtDecode(accessToken);\n      \n      // Update user context\n      login(decodedUser, accessToken);\n\n      // Redirect to the dashboard on successful login\n      alert('Login successful');\n      navigate('/dashboard');\n    } catch (error) {\n      console.error('Login error:', error);\n      setError('Login failed. Please check your username and password.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"container mt-5\">\n      <h2>Login</h2>\n      <form onSubmit={handleLogin} className=\"needs-validation\">\n        <div className=\"mb-3\">\n          <input\n            type=\"text\"\n            placeholder=\"Username\"\n            className=\"form-control\"\n            value={username}\n            onChange={(e) => setUsername(e.target.value)}\n            required\n          />\n        </div>\n        <div className=\"mb-3\">\n          <input\n            type=\"password\"\n            placeholder=\"Password\"\n            className=\"form-control\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            required\n          />\n        </div>\n        <button type=\"submit\" className=\"btn btn-primary\" disabled={loading}>\n          {loading ? 'Logging in...' : 'Login'}\n        </button>\n      </form>\n      {error && <p className=\"text-danger mt-3\">{error}</p>}\n    </div>\n  );\n}\n\nexport default Login;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}